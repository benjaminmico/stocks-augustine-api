schema {
  query: Query
  mutation: Mutation
  subscription: Subscription
}

type Query {
  listCourses(
    filter: FilterInput
    sort: SortInput
    limit: Int
    nextToken: String
  ): CourseConnection
}

input FilterInput @aws_cognito_user_pools {
  attributeName: String!
  attributeValue: String!
}

input SortInput @aws_cognito_user_pools {
  attributeName: String!
  direction: SortDirection!
}

enum SortDirection @aws_cognito_user_pools {
  ASC
  DESC
}

type CourseConnection @aws_cognito_user_pools {
  items: [Course!]!
  nextToken: String
}

type Course @aws_cognito_user_pools {
  id: ID!
  level: Level!
  price: Price!
  type: Type!
  age: Int!
  subjects: [String!]!
  syllabus: [Syllabus!]!
  time: String!
  prerequisites: [String!]
}

enum Level @aws_cognito_user_pools {
  Beginner
  Intermediate
  Advanced
}

enum Price @aws_cognito_user_pools {
  Free
  Paid
}

enum Type @aws_cognito_user_pools {
  Career
  Skill
}

type Syllabus @aws_cognito_user_pools {
  title: String!
  description: String!
  module: Module!
}

type Module @aws_cognito_user_pools {
  type: ModuleType!
  content: String!
}

enum ModuleType @aws_cognito_user_pools {
  Lesson
  Quiz
  Project
}

type Mutation {
  createCourse(course: CourseInput!): Course
    @aws_cognito_user_pools(cognito_groups: ["Admin"])
  updateCourse(course: UpdateCourseInput!): Course
    @aws_cognito_user_pools(cognito_groups: ["Admin"])
  deleteCourse(id: ID!): ID @aws_cognito_user_pools(cognito_groups: ["Admin"])
}

input CourseInput @aws_cognito_user_pools {
  level: Level!
  price: Price!
  type: Type!
  age: Int!
  subjects: [String!]!
  syllabus: [SyllabusInput!]!
  time: String!
  prerequisites: [String!]
}

input UpdateCourseInput @aws_cognito_user_pools {
  id: ID!
  level: Level
  price: Price
  type: Type
  age: Int
  subjects: [String!]
  syllabus: [SyllabusInput!]
  time: String
  prerequisites: [String!]
}

input SyllabusInput @aws_cognito_user_pools {
  title: String!
  description: String!
  module: ModuleInput!
}

input ModuleInput @aws_cognito_user_pools {
  type: ModuleType!
  content: String!
}

type Subscription {
  onCreateCourse: Course @aws_subscribe(mutations: ["createCourse"])
  onUpdateCourse: Course @aws_subscribe(mutations: ["updateCourse"])
  onDeleteCourse: ID @aws_subscribe(mutations: ["deleteCourse"])
}
